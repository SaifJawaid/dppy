.. _UST:

Uniform Spanning Trees
**********************

The Uniform measure on Spanning Trees (UST) of a directed connected graph corresponds to a projection DPP with kernel the transfer current matrix of the graph.
The later is actually the orthogonal projection matrix onto the row span of the vertex-edge incidence matrix.
In fact, one can discard any row of the vertex-edge incidence matrix - note  :math:`A` the resulting matrix - to compute :math:`\mathbf{K}=A^{\top}[AA^{\top}]^{-1}A`.

.. seealso::

    - :py:class:`~dppy.graph.uniform_spanning_tree.UST`
    - Wilson algorithm :cite:`PrWi98`
    - Aldous-Broder :cite:`Ald90`
    - :cite:`Lyo02`

.. important::

    DPPy uses the :code:`networkx` library to handle DPPs related to trees and graphs, but :code:`networkx` is not installed by default when installing DPPy. Please refer to the `installation instructions <https://github.com/guilgautier/DPPy#installation>`_ on GitHub for more details on how to install the necessary dependencies.

.. image:: ../_images/ust_histo.png
    :alt: histogram showing uniformity of the spanning trees generated by the different procedures

.. :ref:`Fig. <ust_context_plot>`

.. _ust_context_plot:

.. plot:: plots/context_plot_uniform_spanning_tree.py
    :context:

.. :ref:`Fig. <ust_graph_plot>`

.. _ust_graph_plot:

.. plot::
    :context:

    # Display underlying kernel i.e. transfer current matrix
    ust.plot_graph()

.. plot:: plots/context_plot_uniform_spanning_tree.py
    :context: reset
    :include-source: False
    :nofigs:

.. :ref:`Fig. <ust_kernel_plot>`

.. _ust_kernel_plot:

.. plot::
    :context:

    # Display underlying kernel i.e. transfer current matrix
    ust.plot_kernel()

.. plot:: plots/context_plot_uniform_spanning_tree.py
    :context: reset
    :include-source: False

.. :ref:`Fig. <ust_samples_plot>`

.. _ust_samples_plot:

.. plot::
    :context:

    # Display some samples
    for md in ('Wilson', 'Aldous-Broder', 'GS'):
        ust.sample(md)
        ust.plot()
